
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.7">
    
    
      
        <title>Add builtin functions - MatrixOne Docs</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.cd566b2a.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700%7C&display=fallback">
        <style>:root{--md-text-font:"Ubuntu";--md-code-font:""}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="mo" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#a-little-primer-for-adding-builtin-functions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://www.matrixorigin.io" title="MatrixOne Docs" class="md-header__button md-logo" aria-label="MatrixOne Docs" data-md-component="logo">
      
  <img src="../../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MatrixOne Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Add builtin functions
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/matrixorigin/matrixone/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    matrixorigin/matrixone
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        MatrixOne
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="https://playground.matrixorigin.io/?tutorial=SSB-test-with-matrixone&step=1" class="md-tabs__link">
        Playground
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://www.matrixorigin.io" title="MatrixOne Docs" class="md-nav__button md-logo" aria-label="MatrixOne Docs" data-md-component="logo">
      
  <img src="../../../../assets/logo.png" alt="logo">

    </a>
    MatrixOne Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/matrixorigin/matrixone/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    matrixorigin/matrixone
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          MatrixOne
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="MatrixOne" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          MatrixOne
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2" type="checkbox" id="__nav_1_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_2">
          Overview
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Overview" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_2">
          <span class="md-nav__icon md-icon"></span>
          Overview
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Overview/matrixone-introduction/" class="md-nav__link">
        MatrixOne Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Overview/matrixone-architecture/" class="md-nav__link">
        MatrixOne Architecture
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2_3" type="checkbox" id="__nav_1_2_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_2_3">
          MatrixCube Tech Design
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="MatrixCube Tech Design" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_2_3">
          <span class="md-nav__icon md-icon"></span>
          MatrixCube Tech Design
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Overview/matrixcube/matrixcube-introduction/" class="md-nav__link">
        MatrixCube Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Overview/matrixcube/matrixcube-auto-rebalance-scheduling/" class="md-nav__link">
        Auto Rebalancing and Scheduling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Overview/matrixcube/matrixcube-shard-splitting/" class="md-nav__link">
        Shard Splitting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Overview/matrixcube/matrixcube-proxy-routing/" class="md-nav__link">
        Shard Proxy and Routing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Overview/mysql-compatibility/" class="md-nav__link">
        MySQL Compatibility
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2_5" type="checkbox" id="__nav_1_2_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_2_5">
          Performance
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Performance" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_2_5">
          <span class="md-nav__icon md-icon"></span>
          Performance
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Overview/SSB%20Test%20Performance/" class="md-nav__link">
        SSB Test Performance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Overview/NYC%20Test%20Performance/" class="md-nav__link">
        NYC Test Performance
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Overview/what%27s-new/" class="md-nav__link">
        What's New
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_3" type="checkbox" id="__nav_1_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_3">
          Get Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Get Started" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_3">
          <span class="md-nav__icon md-icon"></span>
          Get Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../install-standalone-matrixone/" class="md-nav__link">
        Install Standalone MatrixOne
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../install-distributed-matrixone/" class="md-nav__link">
        Install Distributed MatrixOne
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../connect-to-matrixone-server/" class="md-nav__link">
        Connect to MatrixOne Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_3_4" type="checkbox" id="__nav_1_3_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_3_4">
          Tutorial
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorial" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_3_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorial
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../SSB-test-with-matrixone/" class="md-nav__link">
        SSB Test with MatrixOne
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../NYC-test-with-matrixone/" class="md-nav__link">
        NYC Test with MatrixOne
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Playground/" class="md-nav__link">
        Playground
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4" type="checkbox" id="__nav_1_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_4">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_4">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4_1" type="checkbox" id="__nav_1_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_4_1">
          SQL Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="SQL Reference" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_4_1">
          <span class="md-nav__icon md-icon"></span>
          SQL Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4_1_1" type="checkbox" id="__nav_1_4_1_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_4_1_1">
          DDL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="DDL" data-md-level="4">
        <label class="md-nav__title" for="__nav_1_4_1_1">
          <span class="md-nav__icon md-icon"></span>
          DDL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Data-Definition-Statements/create-database/" class="md-nav__link">
        CREATE DATABASE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Data-Definition-Statements/create-table/" class="md-nav__link">
        CREATE TABLE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Data-Definition-Statements/drop-database/" class="md-nav__link">
        DROP DATABASE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Data-Definition-Statements/drop-table/" class="md-nav__link">
        DROP TABLE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Data-Definition-Statements/create-index/" class="md-nav__link">
        CREATE INDEX
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Data-Definition-Statements/drop-index/" class="md-nav__link">
        DROP INDEX
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Data-Definition-Statements/primary-key/" class="md-nav__link">
        PRIMARY KEY
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4_1_2" type="checkbox" id="__nav_1_4_1_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_4_1_2">
          DML
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="DML" data-md-level="4">
        <label class="md-nav__title" for="__nav_1_4_1_2">
          <span class="md-nav__icon md-icon"></span>
          DML
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Data-Manipulation-Statements/insert/" class="md-nav__link">
        INSERT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Data-Manipulation-Statements/load-data/" class="md-nav__link">
        LOAD DATA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Data-Manipulation-Statements/select/" class="md-nav__link">
        SELECT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Data-Manipulation-Statements/show-databases/" class="md-nav__link">
        SHOW DATABASES
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Data-Manipulation-Statements/show-tables/" class="md-nav__link">
        SHOW TABLES
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Data-Manipulation-Statements/use/" class="md-nav__link">
        USE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Data-Manipulation-Statements/like/" class="md-nav__link">
        LIKE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Data-Manipulation-Statements/in/" class="md-nav__link">
        IN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Data-Manipulation-Statements/cast/" class="md-nav__link">
        CAST
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Data-Manipulation-Statements/inner-join/" class="md-nav__link">
        INNER JOIN
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4_1_3" type="checkbox" id="__nav_1_4_1_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_4_1_3">
          Aggregate Functions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Aggregate Functions" data-md-level="4">
        <label class="md-nav__title" for="__nav_1_4_1_3">
          <span class="md-nav__icon md-icon"></span>
          Aggregate Functions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Aggregate-Functions/avg/" class="md-nav__link">
        AVG
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Aggregate-Functions/count/" class="md-nav__link">
        COUNT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Aggregate-Functions/max/" class="md-nav__link">
        MAX
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Aggregate-Functions/min/" class="md-nav__link">
        MIN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/Aggregate-Functions/sum/" class="md-nav__link">
        SUM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/SQL-Reference/data-types/" class="md-nav__link">
        Data Types
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4_2" type="checkbox" id="__nav_1_4_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_4_2">
          Custom Functions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Custom Functions" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_4_2">
          <span class="md-nav__icon md-icon"></span>
          Custom Functions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/Customer-Functions/length/" class="md-nav__link">
        LENGTH()
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/Customer-Functions/floor/" class="md-nav__link">
        FLOOR()
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/Customer-Functions/round/" class="md-nav__link">
        ROUND()
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/Customer-Functions/year/" class="md-nav__link">
        YEAR()
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4_3" type="checkbox" id="__nav_1_4_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_4_3">
          System Paramaters
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="System Paramaters" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_4_3">
          <span class="md-nav__icon md-icon"></span>
          System Paramaters
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/System-Parameters/configuration-settings/" class="md-nav__link">
        General Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Reference/System-Parameters/distributed-settings/" class="md-nav__link">
        Distributed Settings
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_5" type="checkbox" id="__nav_1_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_5">
          FAQs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="FAQs" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_5">
          <span class="md-nav__icon md-icon"></span>
          FAQs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../FAQs/general-faqs/" class="md-nav__link">
        General FAQs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_6" type="checkbox" id="__nav_1_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_6">
          Release Notes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Release Notes" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_6">
          <span class="md-nav__icon md-icon"></span>
          Release Notes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Release-Notes/v0.1.0/" class="md-nav__link">
        v0.1.0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Release-Notes/v0.2.0/" class="md-nav__link">
        v0.2.0
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../glossary/" class="md-nav__link">
        Glossary
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_8" type="checkbox" id="__nav_1_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_8">
          Contribution Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Contribution Guide" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_8">
          <span class="md-nav__icon md-icon"></span>
          Contribution Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution-Guide/make-your-first-contribution/" class="md-nav__link">
        Make Your First Contribution
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_8_2" type="checkbox" id="__nav_1_8_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_8_2">
          How to Contribute
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="How to Contribute" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_8_2">
          <span class="md-nav__icon md-icon"></span>
          How to Contribute
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution-Guide/How-to-Contribute/types-of-contributions/" class="md-nav__link">
        Types of Contributions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution-Guide/How-to-Contribute/preparation/" class="md-nav__link">
        Preparation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution-Guide/How-to-Contribute/report-an-issue/" class="md-nav__link">
        Report an Issue
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution-Guide/How-to-Contribute/contribute-code/" class="md-nav__link">
        Contribute Code
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution-Guide/How-to-Contribute/review-a-pull-request/" class="md-nav__link">
        Review a Pull Request
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution-Guide/How-to-Contribute/contribute-documentation/" class="md-nav__link">
        Contribute Documentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution-Guide/How-to-Contribute/make-a-design/" class="md-nav__link">
        Make a Design
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_8_3" type="checkbox" id="__nav_1_8_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_8_3">
          Code Style
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Code Style" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_8_3">
          <span class="md-nav__icon md-icon"></span>
          Code Style
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution-Guide/Code-Style/code-of-conduct/" class="md-nav__link">
        Code of Conduct
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution-Guide/Code-Style/code-comment-style/" class="md-nav__link">
        Code Comment Style
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution-Guide/Code-Style/commit-pr-style/" class="md-nav__link">
        Commit & Pull Request Style
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Playground
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Playground" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Playground
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://playground.matrixorigin.io/?tutorial=SSB-test-with-matrixone&step=1" class="md-nav__link">
        Playground
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#a-little-primer-for-adding-builtin-functions" class="md-nav__link">
    A little primer for adding builtin functions
  </a>
  
    <nav class="md-nav" aria-label="A little primer for adding builtin functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-unary-functions" class="md-nav__link">
    add unary functions:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-binary-and-variadic-functions-for-matrixone" class="md-nav__link">
    add binary and variadic functions for MatrixOne:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/matrixorigin/matrixone/edit/main/docs/en/MatrixOne/Get-Started/Tutorial/add_builtin_functions.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


  <h1>Add builtin functions</h1>

<h3 id="a-little-primer-for-adding-builtin-functions">A little primer for adding builtin functions</h3>
<h5 id="add-unary-functions">add unary functions:</h5>
<p>In this guide, we use the function abs(get the absolute value) as an example.</p>
<p>Step 1: register function</p>
<p>MatrixOne doesn't distinguish between operators and functions. In our code repository, the file pkg/builtin/types.go register builtin functions as operators and we assign each operator a distinct integer number. To add a new function abs, add a new const Abs in the const declaration.</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="nx">Length</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">iota</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">overload</span><span class="p">.</span><span class="nx">NE</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">    </span><span class="nx">Year</span><span class="w"></span>
<span class="w">    </span><span class="nx">Round</span><span class="w"></span>
<span class="w">    </span><span class="nx">Floor</span><span class="w"></span>
<span class="w">    </span><span class="nx">Abs</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<p>In the directory pkg/builtin/unary, create a new go file abs.go.</p>
<p>This abs.go file has the following functionalities:</p>
<pre><code>1. function name registration
2. declare all the different parameter types this function accepts, and the different return type when given different parameter types.
3. the stringification method for this function.
4. preparation for function calling and function calling.
</code></pre>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">unary</span><span class="w"></span>

<span class="kd">func</span><span class="w"> </span><span class="nx">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>In Golang, init function will be called when a package is initialized. We wrap all abs.go's functionality inside this init function so we don't need to call it explicitly.</p>
<ol>
<li>function name registration</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="nx">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">extend</span><span class="p">.</span><span class="nx">FunctionRegistry</span><span class="p">[</span><span class="s">&quot;abs&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="w"> </span><span class="c1">// register function name</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>In MatrixOne, all letters in a function name will be lowercased during the parsing process, so register function names using only lowercase letters otherwise the function won't be recognized.</p>
<ol>
<li>declare function parameter types and return types.</li>
</ol>
<p>The function abs accepts all numeric types as its parameter(uint8, int8, float32...), we can return a 64bit value covering all different parameter types, or, to optimize the performance of our function, we can return different types with respect to the parameter type.</p>
<p>Outside the init function, declare these variables for each pair of parameter type and return type.</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">argAndRets</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[]</span><span class="nx">argsAndRet</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">{[]</span><span class="nx">types</span><span class="p">.</span><span class="nx">T</span><span class="p">{</span><span class="nx">types</span><span class="p">.</span><span class="nx">T_uint8</span><span class="p">},</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_uint8</span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{[]</span><span class="nx">types</span><span class="p">.</span><span class="nx">T</span><span class="p">{</span><span class="nx">types</span><span class="p">.</span><span class="nx">T_uint16</span><span class="p">},</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_uint16</span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{[]</span><span class="nx">types</span><span class="p">.</span><span class="nx">T</span><span class="p">{</span><span class="nx">types</span><span class="p">.</span><span class="nx">T_uint32</span><span class="p">},</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_uint32</span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{[]</span><span class="nx">types</span><span class="p">.</span><span class="nx">T</span><span class="p">{</span><span class="nx">types</span><span class="p">.</span><span class="nx">T_uint64</span><span class="p">},</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_uint64</span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{[]</span><span class="nx">types</span><span class="p">.</span><span class="nx">T</span><span class="p">{</span><span class="nx">types</span><span class="p">.</span><span class="nx">T_int8</span><span class="p">},</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_int8</span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{[]</span><span class="nx">types</span><span class="p">.</span><span class="nx">T</span><span class="p">{</span><span class="nx">types</span><span class="p">.</span><span class="nx">T_int16</span><span class="p">},</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_int16</span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{[]</span><span class="nx">types</span><span class="p">.</span><span class="nx">T</span><span class="p">{</span><span class="nx">types</span><span class="p">.</span><span class="nx">T_int32</span><span class="p">},</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_int32</span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{[]</span><span class="nx">types</span><span class="p">.</span><span class="nx">T</span><span class="p">{</span><span class="nx">types</span><span class="p">.</span><span class="nx">T_int64</span><span class="p">},</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_int64</span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{[]</span><span class="nx">types</span><span class="p">.</span><span class="nx">T</span><span class="p">{</span><span class="nx">types</span><span class="p">.</span><span class="nx">T_float32</span><span class="p">},</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_float32</span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{[]</span><span class="nx">types</span><span class="p">.</span><span class="nx">T</span><span class="p">{</span><span class="nx">types</span><span class="p">.</span><span class="nx">T_float64</span><span class="p">},</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_float64</span><span class="p">},</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kd">func</span><span class="w"> </span><span class="nx">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">extend</span><span class="p">.</span><span class="nx">FunctionRegistry</span><span class="p">[</span><span class="s">&quot;abs&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="w"> </span><span class="c1">// register function name</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Register parameter types and return types for abs function:</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="nx">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">extend</span><span class="p">.</span><span class="nx">FunctionRegistry</span><span class="p">[</span><span class="s">&quot;abs&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="w"> </span><span class="c1">// register function name</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">item</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">argAndRets</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nx">overload</span><span class="p">.</span><span class="nx">AppendFunctionRets</span><span class="p">(</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">,</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">args</span><span class="p">,</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">ret</span><span class="p">)</span><span class="w"> </span><span class="c1">// append function parameter types and return types</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nx">extend</span><span class="p">.</span><span class="nx">UnaryReturnTypes</span><span class="p">[</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">extend</span><span class="w"> </span><span class="nx">extend</span><span class="p">.</span><span class="nx">Extend</span><span class="p">)</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// define a get return type function for abs function</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">getUnaryReturnType</span><span class="p">(</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">,</span><span class="w"> </span><span class="nx">extend</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Define a stringify function and register abs function type:</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="nx">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">extend</span><span class="p">.</span><span class="nx">FunctionRegistry</span><span class="p">[</span><span class="s">&quot;abs&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="w"> </span><span class="c1">// register function name</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">item</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">argAndRets</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nx">overload</span><span class="p">.</span><span class="nx">AppendFunctionRets</span><span class="p">(</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">,</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">args</span><span class="p">,</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">ret</span><span class="p">)</span><span class="w"> </span><span class="c1">// append function parameter types and return types</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nx">extend</span><span class="p">.</span><span class="nx">UnaryReturnTypes</span><span class="p">[</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">extend</span><span class="w"> </span><span class="nx">extend</span><span class="p">.</span><span class="nx">Extend</span><span class="p">)</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// define a get return type function for abs function</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">getUnaryReturnType</span><span class="p">(</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">,</span><span class="w"> </span><span class="nx">extend</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nx">extend</span><span class="p">.</span><span class="nx">UnaryStrings</span><span class="p">[</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">e</span><span class="w"> </span><span class="nx">extend</span><span class="p">.</span><span class="nx">Extend</span><span class="p">)</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// define a stringify function for abs</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;abs(%s)&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">e</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nx">overload</span><span class="p">.</span><span class="nx">OpTypes</span><span class="p">[</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">overload</span><span class="p">.</span><span class="nx">Unary</span><span class="w"> </span><span class="c1">// register abs function type</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>For simplicity, we demonstrate only two cases where abs function has parameter type float32 and float64.</p>
<p>Preparation for function calling:</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="nx">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">extend</span><span class="p">.</span><span class="nx">FunctionRegistry</span><span class="p">[</span><span class="s">&quot;abs&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="w"> </span><span class="c1">// register function name</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">item</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">argAndRets</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nx">overload</span><span class="p">.</span><span class="nx">AppendFunctionRets</span><span class="p">(</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">,</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">args</span><span class="p">,</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">ret</span><span class="p">)</span><span class="w"> </span><span class="c1">// append function parameter types and return types</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nx">extend</span><span class="p">.</span><span class="nx">UnaryReturnTypes</span><span class="p">[</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">extend</span><span class="w"> </span><span class="nx">extend</span><span class="p">.</span><span class="nx">Extend</span><span class="p">)</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// define a get return type function for abs function</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">getUnaryReturnType</span><span class="p">(</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">,</span><span class="w"> </span><span class="nx">extend</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nx">extend</span><span class="p">.</span><span class="nx">UnaryStrings</span><span class="p">[</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">e</span><span class="w"> </span><span class="nx">extend</span><span class="p">.</span><span class="nx">Extend</span><span class="p">)</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// define a stringify function for abs</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;abs(%s)&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">e</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nx">overload</span><span class="p">.</span><span class="nx">OpTypes</span><span class="p">[</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">overload</span><span class="p">.</span><span class="nx">Unary</span><span class="w"> </span><span class="c1">// register abs function type</span><span class="w"></span>
<span class="w">    </span><span class="nx">overload</span><span class="p">.</span><span class="nx">UnaryOps</span><span class="p">[</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">overload</span><span class="p">.</span><span class="nx">UnaryOp</span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nx">Typ</span><span class="p">:</span><span class="w">        </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_float32</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nx">ReturnType</span><span class="p">:</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_float32</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nx">Fn</span><span class="p">:</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">origVec</span><span class="w"> </span><span class="o">*</span><span class="nx">vector</span><span class="p">.</span><span class="nx">Vector</span><span class="p">,</span><span class="w"> </span><span class="nx">proc</span><span class="w"> </span><span class="o">*</span><span class="nx">process</span><span class="p">.</span><span class="nx">Process</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="nx">vector</span><span class="p">.</span><span class="nx">Vector</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nx">origVecCol</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">origVec</span><span class="p">.</span><span class="nx">Col</span><span class="p">.([]</span><span class="kt">float32</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="nx">resultVector</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="nx">proc</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="nb">int64</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nx">origVecCol</span><span class="p">)),</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">Type</span><span class="p">{</span><span class="nx">Oid</span><span class="p">:</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_float32</span><span class="p">,</span><span class="w"> </span><span class="nx">Size</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">})</span><span class="w"> </span><span class="c1">// get a new types.T_float32 vector to store the result vector</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="nx">results</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">encoding</span><span class="p">.</span><span class="nx">DecodeFloat32Slice</span><span class="p">(</span><span class="nx">resultVector</span><span class="p">.</span><span class="nx">Data</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="nx">results</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">results</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="nx">origVecCol</span><span class="p">)]</span><span class="w"></span>
<span class="w">                </span><span class="nx">resultVector</span><span class="p">.</span><span class="nx">Col</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">results</span><span class="w"></span>
<span class="w">                </span><span class="nx">nulls</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="nx">resultVector</span><span class="p">.</span><span class="nx">Nsp</span><span class="p">,</span><span class="w"> </span><span class="nx">origVec</span><span class="p">.</span><span class="nx">Nsp</span><span class="p">)</span><span class="w">                         </span><span class="c1">// the new vector&#39;s nulls are the same as the original vector</span><span class="w"></span>
<span class="w">                </span><span class="nx">vector</span><span class="p">.</span><span class="nx">SetCol</span><span class="p">(</span><span class="nx">resultVector</span><span class="p">,</span><span class="w"> </span><span class="nx">abs</span><span class="p">.</span><span class="nx">AbsFloat32</span><span class="p">(</span><span class="nx">origVecCol</span><span class="p">,</span><span class="w"> </span><span class="nx">results</span><span class="p">))</span><span class="w"> </span><span class="c1">// set the vector col with the return value from abs.AbsFloat32 function</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="nx">resultVector</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Since the result vector has the same type as the original vector, we could use the original vector to store our result when we don't need our original vector anymore in our execution plan(i.e., the reference count of the original vector is 0 or 1).</p>
<p>To reuse the original vector when possible:</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="nx">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">extend</span><span class="p">.</span><span class="nx">FunctionRegistry</span><span class="p">[</span><span class="s">&quot;abs&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="w"> </span><span class="c1">// register function name</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">item</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">argAndRets</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nx">overload</span><span class="p">.</span><span class="nx">AppendFunctionRets</span><span class="p">(</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">,</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">args</span><span class="p">,</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">ret</span><span class="p">)</span><span class="w"> </span><span class="c1">// append function parameter types and return types</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nx">extend</span><span class="p">.</span><span class="nx">UnaryReturnTypes</span><span class="p">[</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">extend</span><span class="w"> </span><span class="nx">extend</span><span class="p">.</span><span class="nx">Extend</span><span class="p">)</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// define a get return type function for abs function</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">getUnaryReturnType</span><span class="p">(</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">,</span><span class="w"> </span><span class="nx">extend</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nx">extend</span><span class="p">.</span><span class="nx">UnaryStrings</span><span class="p">[</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">e</span><span class="w"> </span><span class="nx">extend</span><span class="p">.</span><span class="nx">Extend</span><span class="p">)</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// define a stringify function for abs</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;abs(%s)&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">e</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nx">overload</span><span class="p">.</span><span class="nx">OpTypes</span><span class="p">[</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">overload</span><span class="p">.</span><span class="nx">Unary</span><span class="w"> </span><span class="c1">// register abs function type</span><span class="w"></span>
<span class="w">    </span><span class="nx">overload</span><span class="p">.</span><span class="nx">UnaryOps</span><span class="p">[</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">overload</span><span class="p">.</span><span class="nx">UnaryOp</span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nx">Typ</span><span class="p">:</span><span class="w">        </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_float32</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nx">ReturnType</span><span class="p">:</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_float32</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nx">Fn</span><span class="p">:</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">origVec</span><span class="w"> </span><span class="o">*</span><span class="nx">vector</span><span class="p">.</span><span class="nx">Vector</span><span class="p">,</span><span class="w"> </span><span class="nx">proc</span><span class="w"> </span><span class="o">*</span><span class="nx">process</span><span class="p">.</span><span class="nx">Process</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="nx">vector</span><span class="p">.</span><span class="nx">Vector</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nx">origVecCol</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">origVec</span><span class="p">.</span><span class="nx">Col</span><span class="p">.([]</span><span class="kt">float32</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="nx">origVec</span><span class="p">.</span><span class="nx">Ref</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">origVec</span><span class="p">.</span><span class="nx">Ref</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// reuse the original vector when we don&#39;t need the original one anymore</span><span class="w"></span>
<span class="w">                    </span><span class="nx">origVec</span><span class="p">.</span><span class="nx">Ref</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">                    </span><span class="nx">abs</span><span class="p">.</span><span class="nx">AbsFloat32</span><span class="p">(</span><span class="nx">origVecCol</span><span class="p">,</span><span class="w"> </span><span class="nx">origVecCol</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="nx">origVec</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="nx">resultVector</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="nx">proc</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="nb">int64</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nx">origVecCol</span><span class="p">)),</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">Type</span><span class="p">{</span><span class="nx">Oid</span><span class="p">:</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_float32</span><span class="p">,</span><span class="w"> </span><span class="nx">Size</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">})</span><span class="w"> </span><span class="c1">// get a new types.T_float32 vector to store the result vector</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="nx">results</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">encoding</span><span class="p">.</span><span class="nx">DecodeFloat32Slice</span><span class="p">(</span><span class="nx">resultVector</span><span class="p">.</span><span class="nx">Data</span><span class="p">)</span><span class="w">               </span><span class="c1">// decode the vector&#39;s data to float32 type</span><span class="w"></span>
<span class="w">                </span><span class="nx">results</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">results</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="nx">origVecCol</span><span class="p">)]</span><span class="w">                                                 </span>
<span class="w">                </span><span class="nx">resultVector</span><span class="p">.</span><span class="nx">Col</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">results</span><span class="w"></span>
<span class="w">                </span><span class="nx">nulls</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="nx">resultVector</span><span class="p">.</span><span class="nx">Nsp</span><span class="p">,</span><span class="w"> </span><span class="nx">origVec</span><span class="p">.</span><span class="nx">Nsp</span><span class="p">)</span><span class="w">                         </span><span class="c1">// the new vector&#39;s nulls are the same as the original vector</span><span class="w"></span>
<span class="w">                </span><span class="nx">vector</span><span class="p">.</span><span class="nx">SetCol</span><span class="p">(</span><span class="nx">resultVector</span><span class="p">,</span><span class="w"> </span><span class="nx">abs</span><span class="p">.</span><span class="nx">AbsFloat32</span><span class="p">(</span><span class="nx">origVecCol</span><span class="p">,</span><span class="w"> </span><span class="nx">results</span><span class="p">))</span><span class="w"> </span><span class="c1">// set the vector col with the return value from abs.AbsFloat32 function</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="nx">resultVector</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>For float64 type parameter:</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="nx">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">extend</span><span class="p">.</span><span class="nx">FunctionRegistry</span><span class="p">[</span><span class="s">&quot;abs&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="w"> </span><span class="c1">// register function name</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">item</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">argAndRets</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nx">overload</span><span class="p">.</span><span class="nx">AppendFunctionRets</span><span class="p">(</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">,</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">args</span><span class="p">,</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">ret</span><span class="p">)</span><span class="w"> </span><span class="c1">// append function parameter types and return types</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nx">extend</span><span class="p">.</span><span class="nx">UnaryReturnTypes</span><span class="p">[</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">extend</span><span class="w"> </span><span class="nx">extend</span><span class="p">.</span><span class="nx">Extend</span><span class="p">)</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// define a get return type function for abs function</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">getUnaryReturnType</span><span class="p">(</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">,</span><span class="w"> </span><span class="nx">extend</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nx">extend</span><span class="p">.</span><span class="nx">UnaryStrings</span><span class="p">[</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">e</span><span class="w"> </span><span class="nx">extend</span><span class="p">.</span><span class="nx">Extend</span><span class="p">)</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// define a stringify function for abs</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;abs(%s)&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">e</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nx">overload</span><span class="p">.</span><span class="nx">OpTypes</span><span class="p">[</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">overload</span><span class="p">.</span><span class="nx">Unary</span><span class="w"> </span><span class="c1">// register abs function type</span><span class="w"></span>
<span class="w">    </span><span class="nx">overload</span><span class="p">.</span><span class="nx">UnaryOps</span><span class="p">[</span><span class="nx">builtin</span><span class="p">.</span><span class="nx">Abs</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">overload</span><span class="p">.</span><span class="nx">UnaryOp</span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nx">Typ</span><span class="p">:</span><span class="w">        </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_float32</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nx">ReturnType</span><span class="p">:</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_float32</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nx">Fn</span><span class="p">:</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">origVec</span><span class="w"> </span><span class="o">*</span><span class="nx">vector</span><span class="p">.</span><span class="nx">Vector</span><span class="p">,</span><span class="w"> </span><span class="nx">proc</span><span class="w"> </span><span class="o">*</span><span class="nx">process</span><span class="p">.</span><span class="nx">Process</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="nx">vector</span><span class="p">.</span><span class="nx">Vector</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nx">origVecCol</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">origVec</span><span class="p">.</span><span class="nx">Col</span><span class="p">.([]</span><span class="kt">float32</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="nx">origVec</span><span class="p">.</span><span class="nx">Ref</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">origVec</span><span class="p">.</span><span class="nx">Ref</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// reuse the original vector when we don&#39;t need the original one anymore</span><span class="w"></span>
<span class="w">                    </span><span class="nx">origVec</span><span class="p">.</span><span class="nx">Ref</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">                    </span><span class="nx">abs</span><span class="p">.</span><span class="nx">AbsFloat32</span><span class="p">(</span><span class="nx">origVecCol</span><span class="p">,</span><span class="w"> </span><span class="nx">origVecCol</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="nx">origVec</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="nx">resultVector</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="nx">proc</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="nb">int64</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nx">origVecCol</span><span class="p">)),</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">Type</span><span class="p">{</span><span class="nx">Oid</span><span class="p">:</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_float32</span><span class="p">,</span><span class="w"> </span><span class="nx">Size</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">})</span><span class="w"> </span><span class="c1">// get a new types.T_float32 vector to store the result vector</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="nx">results</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">encoding</span><span class="p">.</span><span class="nx">DecodeFloat32Slice</span><span class="p">(</span><span class="nx">resultVector</span><span class="p">.</span><span class="nx">Data</span><span class="p">)</span><span class="w">   </span><span class="c1">// decode the vector&#39;s data to float32 type</span><span class="w"></span>
<span class="w">                </span><span class="nx">results</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">results</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="nx">origVecCol</span><span class="p">)]</span><span class="w"></span>
<span class="w">                </span><span class="nx">resultVector</span><span class="p">.</span><span class="nx">Col</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">results</span><span class="w"></span>
<span class="w">                </span><span class="nx">nulls</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="nx">resultVector</span><span class="p">.</span><span class="nx">Nsp</span><span class="p">,</span><span class="w"> </span><span class="nx">origVec</span><span class="p">.</span><span class="nx">Nsp</span><span class="p">)</span><span class="w">                         </span><span class="c1">// the new vector&#39;s nulls are the same as the original vector</span><span class="w"></span>
<span class="w">                </span><span class="nx">vector</span><span class="p">.</span><span class="nx">SetCol</span><span class="p">(</span><span class="nx">resultVector</span><span class="p">,</span><span class="w"> </span><span class="nx">abs</span><span class="p">.</span><span class="nx">AbsFloat32</span><span class="p">(</span><span class="nx">origVecCol</span><span class="p">,</span><span class="w"> </span><span class="nx">results</span><span class="p">))</span><span class="w"> </span><span class="c1">// set the vector col with the return value from abs.AbsFloat32 function</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="nx">resultVector</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nx">Typ</span><span class="p">:</span><span class="w">        </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_float64</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nx">ReturnType</span><span class="p">:</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_float64</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nx">Fn</span><span class="p">:</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">origVec</span><span class="w"> </span><span class="o">*</span><span class="nx">vector</span><span class="p">.</span><span class="nx">Vector</span><span class="p">,</span><span class="w"> </span><span class="nx">proc</span><span class="w"> </span><span class="o">*</span><span class="nx">process</span><span class="p">.</span><span class="nx">Process</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="nx">vector</span><span class="p">.</span><span class="nx">Vector</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nx">origVecCol</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">origVec</span><span class="p">.</span><span class="nx">Col</span><span class="p">.([]</span><span class="kt">float64</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="nx">origVec</span><span class="p">.</span><span class="nx">Ref</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">origVec</span><span class="p">.</span><span class="nx">Ref</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="nx">origVec</span><span class="p">.</span><span class="nx">Ref</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">                    </span><span class="nx">abs</span><span class="p">.</span><span class="nx">AbsFloat64</span><span class="p">(</span><span class="nx">origVecCol</span><span class="p">,</span><span class="w"> </span><span class="nx">origVecCol</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="nx">origVec</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="nx">resultVector</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="nx">proc</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="o">*</span><span class="nb">int64</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nx">origVecCol</span><span class="p">)),</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">Type</span><span class="p">{</span><span class="nx">Oid</span><span class="p">:</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">T_float64</span><span class="p">,</span><span class="w"> </span><span class="nx">Size</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">})</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="nx">results</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">encoding</span><span class="p">.</span><span class="nx">DecodeFloat64Slice</span><span class="p">(</span><span class="nx">resultVector</span><span class="p">.</span><span class="nx">Data</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="nx">results</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">results</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="nx">origVecCol</span><span class="p">)]</span><span class="w"></span>
<span class="w">                </span><span class="nx">resultVector</span><span class="p">.</span><span class="nx">Col</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">results</span><span class="w"></span>
<span class="w">                </span><span class="nx">nulls</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="nx">resultVector</span><span class="p">.</span><span class="nx">Nsp</span><span class="p">,</span><span class="w"> </span><span class="nx">origVec</span><span class="p">.</span><span class="nx">Nsp</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="nx">vector</span><span class="p">.</span><span class="nx">SetCol</span><span class="p">(</span><span class="nx">resultVector</span><span class="p">,</span><span class="w"> </span><span class="nx">abs</span><span class="p">.</span><span class="nx">AbsFloat64</span><span class="p">(</span><span class="nx">origVecCol</span><span class="p">,</span><span class="w"> </span><span class="nx">results</span><span class="p">))</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="nx">resultVector</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Step 2: Implement Abs function</p>
<p>In MatrixOne, We put all of our builtin function definition code in the vectorize directory, to implement abs functions, first we need to create a subdirectory abs in this vectorize directory.
In this fresh abs directory, create a file abs.go, the place where our abs function implementation code goes.
For certain cpu architectures, we could utilize the cpu's intrinsic SIMD instruction to compute the absolute value and hence boost our function's performance, to differentiate function implementations for different cpu architectures, we declare our pure go version of abs function this way:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">abs</span><span class="w"></span>

<span class="kd">var</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="nx">absFloat32</span><span class="w"> </span><span class="kd">func</span><span class="p">([]</span><span class="kt">float32</span><span class="p">,</span><span class="w"> </span><span class="p">[]</span><span class="kt">float32</span><span class="p">)</span><span class="w"> </span><span class="p">[]</span><span class="kt">float32</span><span class="w"></span>
<span class="w">    </span><span class="nx">absFloat64</span><span class="w"> </span><span class="kd">func</span><span class="p">([]</span><span class="kt">float64</span><span class="p">,</span><span class="w"> </span><span class="p">[]</span><span class="kt">float64</span><span class="p">)</span><span class="w"> </span><span class="p">[]</span><span class="kt">float64</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>

<span class="kd">func</span><span class="w"> </span><span class="nx">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">absFloat32</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">absFloat32Pure</span><span class="w"></span>
<span class="w">    </span><span class="nx">absFloat64</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">absFloat64Pure</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kd">func</span><span class="w"> </span><span class="nx">AbsFloat32</span><span class="p">(</span><span class="nx">xs</span><span class="p">,</span><span class="w"> </span><span class="nx">rs</span><span class="w"> </span><span class="p">[]</span><span class="kt">float32</span><span class="p">)</span><span class="w"> </span><span class="p">[]</span><span class="kt">float32</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">absFloat32</span><span class="p">(</span><span class="nx">xs</span><span class="p">,</span><span class="w"> </span><span class="nx">rs</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kd">func</span><span class="w"> </span><span class="nx">absFloat32Pure</span><span class="p">(</span><span class="nx">xs</span><span class="p">,</span><span class="w"> </span><span class="nx">rs</span><span class="w"> </span><span class="p">[]</span><span class="kt">float32</span><span class="p">)</span><span class="w"> </span><span class="p">[]</span><span class="kt">float32</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kd">func</span><span class="w"> </span><span class="nx">AbsFloat64</span><span class="p">(</span><span class="nx">xs</span><span class="p">,</span><span class="w"> </span><span class="nx">rs</span><span class="w"> </span><span class="p">[]</span><span class="kt">float64</span><span class="p">)</span><span class="w"> </span><span class="p">[]</span><span class="kt">float64</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">absFloat64</span><span class="p">(</span><span class="nx">xs</span><span class="p">,</span><span class="w"> </span><span class="nx">rs</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kd">func</span><span class="w"> </span><span class="nx">absFloat64Pure</span><span class="p">(</span><span class="nx">xs</span><span class="p">,</span><span class="w"> </span><span class="nx">rs</span><span class="w"> </span><span class="p">[]</span><span class="kt">float64</span><span class="p">)</span><span class="w"> </span><span class="p">[]</span><span class="kt">float64</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Inside the absFloat32Pure and absFloat64Pure, we implement our golang version of abs function for float32 and float64 type.</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="nx">absFloat32Pure</span><span class="p">(</span><span class="nx">xs</span><span class="p">,</span><span class="w"> </span><span class="nx">rs</span><span class="w"> </span><span class="p">[]</span><span class="kt">float32</span><span class="p">)</span><span class="w"> </span><span class="p">[]</span><span class="kt">float32</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">xs</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="nx">xs</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">         </span><span class="nx">rs</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="nx">xs</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">         </span><span class="nx">rs</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">xs</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nx">rs</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="nx">absFloat64Pure</span><span class="p">(</span><span class="nx">xs</span><span class="p">,</span><span class="w"> </span><span class="nx">rs</span><span class="w"> </span><span class="p">[]</span><span class="kt">float64</span><span class="p">)</span><span class="w"> </span><span class="p">[]</span><span class="kt">float64</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">xs</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="nx">xs</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">         </span><span class="nx">rs</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="nx">xs</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">         </span><span class="nx">rs</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">xs</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nx">rs</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Here we go. Now we can fire up MatrixOne and take our abs function for a little spin.</p>
<p><div class="highlight"><pre><span></span><code><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">abs_test_table</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="nb">float</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">double</span><span class="p">);</span><span class="w"></span>
<span class="n">Query</span><span class="w"> </span><span class="n">OK</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="n">affected</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">44</span><span class="w"> </span><span class="n">sec</span><span class="p">)</span><span class="w"></span>

<span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">abs_test_table</span><span class="w"> </span><span class="k">values</span><span class="p">(</span><span class="mi">12</span><span class="p">.</span><span class="mi">34</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">43</span><span class="p">.</span><span class="mi">21</span><span class="p">);</span><span class="w"></span>
<span class="n">Query</span><span class="w"> </span><span class="n">OK</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">row</span><span class="w"> </span><span class="n">affected</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">08</span><span class="w"> </span><span class="n">sec</span><span class="p">)</span><span class="w"></span>

<span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">abs_test_table</span><span class="w"> </span><span class="k">values</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">.</span><span class="mi">34</span><span class="p">,</span><span class="w"> </span><span class="mi">43</span><span class="p">.</span><span class="mi">21</span><span class="p">);</span><span class="w"></span>
<span class="n">Query</span><span class="w"> </span><span class="n">OK</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">row</span><span class="w"> </span><span class="n">affected</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">02</span><span class="w"> </span><span class="n">sec</span><span class="p">)</span><span class="w"></span>

<span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">abs_test_table</span><span class="w"> </span><span class="k">values</span><span class="p">(</span><span class="mi">2</span><span class="p">.</span><span class="mi">718</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">14</span><span class="p">);</span><span class="w"></span>
<span class="n">Query</span><span class="w"> </span><span class="n">OK</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">row</span><span class="w"> </span><span class="n">affected</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">02</span><span class="w"> </span><span class="n">sec</span><span class="p">)</span><span class="w"></span>

<span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="k">abs</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="w"> </span><span class="k">abs</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">abs_test_table</span><span class="p">;</span><span class="w"></span>
<span class="o">+</span><span class="c1">----------+----------+---------+---------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">a</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="n">b</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="k">abs</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="k">abs</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w">  </span><span class="o">|</span><span class="w"></span>
<span class="o">+</span><span class="c1">----------+----------+---------+---------+</span>
<span class="o">|</span><span class="w">  </span><span class="mi">12</span><span class="p">.</span><span class="mi">3400</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mi">43</span><span class="p">.</span><span class="mi">2100</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">12</span><span class="p">.</span><span class="mi">3400</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">43</span><span class="p">.</span><span class="mi">2100</span><span class="w"> </span><span class="o">|</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mi">12</span><span class="p">.</span><span class="mi">3400</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="mi">43</span><span class="p">.</span><span class="mi">2100</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">12</span><span class="p">.</span><span class="mi">3400</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">43</span><span class="p">.</span><span class="mi">2100</span><span class="w"> </span><span class="o">|</span><span class="w"></span>
<span class="o">|</span><span class="w">   </span><span class="mi">2</span><span class="p">.</span><span class="mi">7180</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">1400</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="mi">2</span><span class="p">.</span><span class="mi">7180</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="mi">3</span><span class="p">.</span><span class="mi">1400</span><span class="w"> </span><span class="o">|</span><span class="w"></span>
<span class="o">+</span><span class="c1">----------+----------+---------+---------+</span>
<span class="mi">3</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span><span class="w"> </span><span class="n">sec</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
Bingo!</p>
<h5 id="add-binary-and-variadic-functions-for-matrixone">add binary and variadic functions for MatrixOne:</h5>
<p>MatrixOne has some neat examples for adding binary and variadic functions(bitAnd function, floor function, etc. ), with some minor corresponding changes, the procedure is quite the same as the unary function.</p>
<p>​</p>
<p>Special thanks to <a href="https://github.com/nnsgmsone">nnsgmsone</a>!</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../../assets/javascripts/workers/search.22074ed6.min.js", "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.01de222e.min.js"></script>
      
    
  </body>
</html>